import*as e from"firebase-functions/v2/https";import*as t from"firebase-functions/v2/firestore";import*as r from"firebase-admin";import*as n from"firebase-functions/params";!function(e,t,r,n,o){var a="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{},i="function"==typeof a[n]&&a[n],s=i.i||{},f=i.cache||{},u="u">typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(t,r){if(!f[t]){if(!e[t]){if(o[t])return o[t];var s="function"==typeof a[n]&&a[n];if(!r&&s)return s(t,!0);if(i)return i(t,!0);if(u&&"string"==typeof t)return u(t);var d=Error("Cannot find module '"+t+"'");throw d.code="MODULE_NOT_FOUND",d}p.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},p.cache={};var l=f[t]=new c.Module(t);e[t][0].call(l.exports,p,l,l.exports,a)}return f[t].exports;function p(e){var t=p.resolve(e);if(!1===t)return{};if(Array.isArray(t)){var r={__esModule:!0};return t.forEach(function(e){var t=e[0],n=e[1],o=e[2]||e[0],a=c(n);"*"===t?Object.keys(a).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}})}):"*"===o?Object.defineProperty(r,t,{enumerable:!0,value:a}):Object.defineProperty(r,t,{enumerable:!0,get:function(){return"default"===o?a.__esModule?a.default:a:a[o]}})}),r}return c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.require=u,this.exports={}},c.modules=e,c.cache=f,c.parent=i,c.distDir=void 0,c.publicUrl=void 0,c.devServer=void 0,c.i=s,c.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(c,"root",{get:function(){return a[n]}}),a[n]=c;for(var d=0;d<t.length;d++)c(t[d]);if(r){var l=c(r);"object"==typeof exports&&"u">typeof module?module.exports=l:"function"==typeof define&&define.amd&&define(function(){return l})}}({hvHOb:[function(e,t,r,n){let{onCall:o,HttpsError:a}=e("6e5ba99a3898774"),{onDocumentUpdated:i}=e("54b7f8f09c84ae87"),s=e("f64189c020066c10"),{defineSecret:f}=e("255b8858d6a1d3f8");s.initializeApp();let u=s.firestore(),c=f("ACCESS_KEY");r.verifyAccessKey=o({secrets:[c]},async e=>{if(e.data.password!==c.value())throw new a("permission-denied","Invalid Access Key");let t=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;try{return{token:await s.auth().createCustomToken(t,{role:"participant"})}}catch(e){throw console.error("Error creating custom token:",e),new a("internal","Unable to generate session token")}}),r.onMessageUpdate=i("messages/{messageId}",async e=>{let t=e.data.before.data(),r=e.data.after.data(),n=e.params.messageId,o=s.firestore.Timestamp.now();!0===t.visible&&!1===r.visible?await u.collection("audit_logs").add({event_type:"WITHDRAW",target_message_id:n,actor_uid:r.auth_uid,snapshot_data:{content:t.content,display_name:t.display_name},timestamp:o}):t.content!==r.content&&!0===r.visible&&await u.collection("audit_logs").add({event_type:"EDIT",target_message_id:n,actor_uid:r.auth_uid,previous_content:t.content,new_content:r.content,timestamp:o})})},{"6e5ba99a3898774":"firebase-functions/v2/https","54b7f8f09c84ae87":"firebase-functions/v2/firestore",f64189c020066c10:"firebase-admin","255b8858d6a1d3f8":"firebase-functions/params"}]},["hvHOb"],"hvHOb","parcelRequiref384",{"firebase-functions/v2/https":e,"firebase-functions/v2/firestore":t,"firebase-admin":r,"firebase-functions/params":n});let{"*":o}=parcelRequiref384("hvHOb");export{o as default};
//# sourceMappingURL=Private-chat-powered-by-iro--main.37682321.js.map
